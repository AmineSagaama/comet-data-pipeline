<div class="home-page page-content">
	<div class="container-fluid">
		<div class="row">
			<div class="col-lg-12">
				<div pDraggable="rts" (onDragStart)="dragStart($event, rt)" (onDragEnd)="dragEnd($event)" (click)="openListServers(rt.id)"
					class="rtElement mt-3 mr-3 px-3 py-2" ngClass="rtElement_{{rt.id}}" *ngFor="let rt of resourceTypes; let i = index">{{rt.name}} <i class="fa fa-arrows"></i></div>
			</div>
		</div>
		<div class="row my-4">
			<div class="col-lg-12">
				<p-table [autoLayout]="true" [value]="servers">
					<ng-template pTemplate="header">
						<tr>
							<th>Server Name <i class="add pull-right fa fa-plus-circle fa-2x" (click)="showAddServer = true"></i></th>
							<th>Resource Types</th>
						</tr>
					</ng-template>
					<ng-template pTemplate="body" let-server>
						<tr>
							<td>{{server.name}}</td>
							<td pDroppable="rts" (onDrop)="drop($event)" [ngClass]="{'highlight':draggedItem, 'empty': server.rts.length == 0}" [attr.data-server-id] = "server.id">
								<div *ngFor="let rt of server.rts" class="rtElement my-2 mr-3 px-3" ngClass="rtElement_{{rt.tag.id}}" (click)="openResourceType(rt, server.id)">{{rt.tag.name}}</div>
							</td>
						</tr>
					</ng-template>
				</p-table>
			</div>
		</div>
	</div>
</div>

<p-dialog header="Add New Server" [(visible)]="showAddServer" [modal]="true" [responsive]="true" [width]="500"  [resizable]="false" [focusOnShow]="false" (onHide)="closeNewServerForm()">
    <div class="mt-3">
		<form [formGroup]="newServerForm">
			<input type="text" [ngClass]="['form-control', getValidity(newServerNameCtl)]" formControlName="name" placeholder="Server Name"/>
			<small *ngIf="newServerNameCtl && newServerNameCtl.invalid && newServerNameCtl.dirty" class="error">
				Ce champs est requis
			</small>
		</form>
	</div>
	<p-footer>
		<button type="button" class="btn btn-secondary" (click)="closeNewServerForm()">Cancel</button>
		<button type="button" class="btn btn-primary ml-2" (click)="addNewServer()">Save</button>
	</p-footer>
</p-dialog>

<list-servers-dialog
			[servers]="servers"
			[tagId]="selectedTagId"
			[visible]="showListServers"
			(onSubmit)="saveListServers($event)"
			(onClose)="closeListServers()"></list-servers-dialog>

<resource-type-details
			[servers]="servers"
			[serverId]="selectedServerId"
			[resourceType]="selectedResourceType"
			[visible]="showResourceTypeDialog"
			(onSubmit)="saveResourceType($event)"
			(onClose)="closeResourceType()"></resource-type-details>